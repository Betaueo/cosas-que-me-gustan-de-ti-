const loveMessages = [
    "Tu sonrisa ilumina mi d칤a",
    "Amo tu forma de ver el mundo",
    "Tu risa es mi sonido favorito",
    "Me encanta c칩mo me haces sentir",
    "Amo tu determinaci칩n y fuerza",
    "Amo cada momento contigo",
    "Tu inteligencia me asombra",
    "Amo c칩mo me apoyas en todo",
    "Amo tu nariz, es una de las caracter칤sticas que me gusta",
    "Amo c칩mo nuestra conexi칩n va m치s all치 de las palabras.", 
    "Amo c칩mo nunca temes ser t칰 misma, incluso en las situaciones m치s dif칤ciles.",
    "Amo c칩mo eres t칤mida a veces.", 
    "Amo c칩mo haces que cualquier lugar se sienta como el mejor lugar del mundo.",
    "Amo c칩mo tomas las decisiones con seguridad, siempre sabiendo lo que es mejor para ti y para los dem치s.", 
    "Amo c칩mo siempre tienes algo inteligente que decir como lo de los magos y manga.", 
    "Tus pies peque침os me gustan, como tus manos. Yo digo que si te las (chuparia).",
    "Tus pensamientos siempre me sorprenden, eres mucho m치s profunda de lo que cualquiera podr칤a imaginar. ", 
   "Amo disfrutar del silencio, contigo, incluso los momentos en silencio son significativos. ",
   "Tu risa, aunque la escucho mil veces, siempre me parece la mejor", 
   "Amo c칩mo usas tu sentido de la moda pero todo te queda bien, mi amor. ",
   "Me encanta cuando haces esa mueca divertida justo antes de contarme algo gracioso", 
   "Amo c칩mo te expresas aunq te cuesta un poquito", 
   "Amo c칩mo puedes ser seria y graciosa en cuesti칩n de segundos.", 
   "Amo c칩mo puedes ser tan fuerte sin dejar de ser delicada. ", 
  "Cada vez que cantas sin darte cuenta me quedo vi칠ndote", 
  "Amo c칩mo puedes hablar con seguridad de cualquier tema, me encanta escucharte.",
  "Me fascina c칩mo a veces te r칤es de tus propios chistes antes de terminarlos. ", 
  "Amo c칩mo siempre encuentras algo nuevo que ense침arme, cada d칤a contigo aprendo m치s de algo cielo JAJAJA.", 
  "Sabes. Tus hombros, aunque peque침os, cargan con la fuerza de alguien que sabe lo que quiere. ", 
  "Tu manera de escucharme, de verdad escucharme, es algo que nunca hab칤a experimentado antes. ", 
  "Amo la manera en que miras las estrellas, siempre tan llena de curiosidad. ", 
  "Tu forma de ser tan genuina me hace sentir afortunado de tenerte en mi vida. ", 
  "Amo c칩mo tienes una historia interesante detr치s de cada cosa que haces ", 
  "Amo tus historias. ", 
  "Tu lealtad es una de tus cualidades m치s hermosas espero nunca cambie.",
  "Amo c칩mo disfrutas de las cosas sencillas sin complicarte. ", 
  "Amo tus berrinches qu칠 a veces haces. ", 
  "Tu forma de pensar es algo que siempre me gustara. ", 
  "Tu capacidad de perdonar y seguir adelante es admirable siento que aprendes. ", 
  "Amo c칩mo aprecias la naturaleza", 
  "Amo c칩mo logras encontrar siempre una Raz칩n JAJAJA para decirme que eso pienso yo"
 
    
     
];

const randomLoveMessages = [
    "Mi amor, como te explico que t칰 eres el centro de mesa y yo soy la se침ora que te quiere llevar.",
    "Contigo, hasta las ma침anas de lunes se sienten como domingos.",
    "Eres mi notificaci칩n favorita, siempre quiero saber m치s de ti si miras esto al menos una?.",
    "Quisiera ser ladron,lo por la acci칩n ni la emoci칩n sino para robarte tu hermoso coraz칩n","la vida es bella,pero es m치s bella porque t칰 est치s en ella contigo todo es genial y sin ti nada ser칤a igual para m칤. tu eres en verdad especial para m칤 y eso no se puede negar", 
    "EN LA VIDA SE VE EL AMOR ,EN LA TIERRA SE VE LA VERDAD Y EN TI MIRO MI FELICIDAD Y LA QUE AMO Y  NO PODRE OLVIDAR", 
    "El mar es mar,la botella es botella y tu por dentro y por fuera sigues estando igual de bella (te amo muchito mi amor hermoso) ", 
    "El cielo puede ser azul,la tierra marron pero yo solamente quiero ser una parte de tu hermoso coraz칩n", 
  "No es amanecer, no es atardecer, eres t칰 qu칠 me ilusiona con tu forma de ser", 
  "te busco en mi sombra pero no te encuentro, ser치 que es porq ya te tengo a mi lado?", 
  "Cuando mires las estrellas acuerdate de mi, por q en cada  una de ellas hay un beso para ti", 
  "Me gustar칤a ser mariposa y volar de flor a flor y llegar a tu casa y decirte [Hola Mi Amor] 游붊", 
  "Con tu mirada me enamore , de tus ojos me ilusione,y desde el fondo de mi coraz칩n siempre te amar칠 tu me gustas mucho pher 游눟", 
  "En el jardin de mi coraz칩n, florecen palabras llenas de amor. Eres la mujer en la cual si estoy interesado , la luz que ilumina mis ojos de tanto amor tt: de m칤 para ti mi cielo ", 
  "Aun te acuerdas de: T칰 me gustas mucho como a ti te gustan las gomitas "
  
    
    
    
];



const meEncantanMessages = [
"Me encantan tus ojos - por el simple hecho de que en ellos encuentro mi paz y el reflejo de todo lo que amo.",

"Me encanta 칩mo me  mias  porque en tu mirada encuentro tranquilidad y confianza.", 

"Me encanta tu risa,porque es genuina y contagiosa, llena de vida", 

"Me encantan tus abrazos,porque siempre me hacen sentir que estoy en el lugar correcto", 

"Me encanta la manera en  que hablas,porque siempre tienes algo interesante o sincero que decir", 

"Me encanta tu forma de pensar,porque siempre tienes una perspectiva que me hace reflexionar",

"Me encanta c칩mo eres tan aut칠ntica,porque nunca intentas ser alguien m치s",

"Me encanta tu fuerza,porque a pesar de todo, siempre encuentras la manera de seguir adelante",

"Me encanta tu sentido del humor,porque siempre sabes c칩mo hacerme re칤r tienes una personalidad q me gusta ",

"Me encantan tus peque침os detalles,porque demuestran lo mucho que te importa nuestra relaci칩n aunq tus detalles sean m치s verbales",

"Me encanta tu sinceridad,porque no importa lo que pase, siempre dices lo que piensas",

"Me encanta c칩mo me haces sentir,porque contigo siempre siento que soy la mejor versi칩n de m칤",

"Me encanta tu curiosidad,porque siempre est치s buscando aprender algo nuevo, pero no hay que probar cosas o칤ste", 

"Me encanta c칩mo disfrutas de las cosas simples,porque me ense침as a apreciaraunq momentos peque침os",

"Me encanta tu pasi칩n por lo que haces,porque siempre das lo mejor de ti en todo aunq a veces te molestes", 

"Me encanta c칩mo cuidas de los dem치s por ejemplo tu hermano,porque siempre te preocupas por el bienestar ( bueno m치s o menos)",

"Me encanta tu paciencia,porque sabes esperar y entender cuando las cosas se complican",

"Me encanta tu determinaci칩n,porque siempre vas tras lo que quieres sin dudar", 

"Me encanta c칩mo valoras la honestidad,porque me haces sentir seguro de ser siempre yo mismo y de tratarte de decir las cosas",

"Me encanta tu creatividad,porque siempre encuentras formas 칰nicas de ver el mundo",

"aunque pienses que no eres buena en algo en m치s de alguna cosa lo eres, solo falta que te des cuenta mi amor, (te amo)", 

"Me encanta c칩mo manejas los problemas, porque enfrentas todo con calma y madurez",

"Me encanta tu independencia,porque demuestras que eres fuerte por ti misma",

"S칠 que sonara ego칤sta y todo pero no quiera q te fueras a otro lugar en el cual no est칠s cerca de m칤", 

"Me encanta la confianza que me transmites,porque s칠 que puedo contar contigo en todo momento",

"Me encanta tu inteligencia,porque siempre tienes algo interesante que aportar",

"Me encanta tu capacidad de mostrar afecto,porque siempre haces que me sienta amado de una manera 칰nica",

"Me encanta c칩mo eres mi mejor amiga y mi pareja,porque en ti encuentro amor y compa침칤a en igual medida", 

"Me encanta c칩mo me motivas a no rendirme,porque siempre sabes c칩mo darme fuerzas cuando lo necesito", 

"Me encanta c칩mo valoras el respeto mutuo,porque entiendes lo importante que es en una relaci칩n sana",

"Mee encanta tu dulzura,porque sin perder tu fortaleza, siempre tienes un gesto amable para m칤",

"Me encanta c칩mo compartes tus sue침os conmigo,porque me haces parte de lo que m치s te apasiona", 

"Me encanta c칩mo nunca dejas que los malos momentos nos definan,porque siempre buscas superar los retos",
"Me encanta c칩mo me haces sentir que soy suficiente,porque contigo nunca siento que deba ser alguien m치s", 

"Me encanta c칩mo cuidas nuestros planes a futuro,porque demuestras que nuestra relaci칩n siempre est치 en tus pensamientos",  

"Me encanta c칩mo, a pesar de los a침os, seguimos descubriendo cosas nuevas juntos,porque a tu lado, la vida siempre es una aventura"

];

// Variables para manejar el mensaje del d칤a
const today = new Date().toISOString().split('T')[0];  // Obtener la fecha actual (YYYY-MM-DD)
let lastShownDate = localStorage.getItem('lastShownDate');
let lastShownMessage = localStorage.getItem('lastShownMessage');

// Funci칩n para seleccionar la categor칤a del d칤a basado en probabilidades
function selectMessageCategory() {
    const randomValue = Math.random();
    let selectedCategory = '';

    if (randomValue < 0.50) {
        selectedCategory = 'Cosas que Amo de Ti';  // 50% de probabilidad
    } else if (randomValue < 0.85) {
        selectedCategory = 'Cosas Random de Amor';  // 35% de probabilidad
    } else {
        selectedCategory = 'Cosas que Me Encantan de Ti';  // 15% de probabilidad
    }

    localStorage.setItem('selectedCategory', selectedCategory);
    return selectedCategory;
}

// Mostrar el mensaje correspondiente al d칤a
function displayDailyMessage() {
    const selectedCategory = localStorage.getItem('selectedCategory') || selectMessageCategory();
    const titleElement = document.getElementById('section-title');
    const messageElement = document.getElementById('love-message');

    titleElement.textContent = selectedCategory;

    // Si es un nuevo d칤a o no hay mensaje almacenado, seleccionamos uno nuevo
    if (lastShownDate !== today || !lastShownMessage) {
        let message = '';
        if (selectedCategory === 'Cosas que Amo de Ti') {
            const messageIndex = Math.floor(Math.random() * loveMessages.length);
            message = loveMessages[messageIndex];
        } else if (selectedCategory === 'Cosas Random de Amor') {
            const messageIndex = Math.floor(Math.random() * randomLoveMessages.length);
            message = randomLoveMessages[messageIndex];
        } else if (selectedCategory === 'Cosas que Me Encantan de Ti') {
            const messageIndex = Math.floor(Math.random() * meEncantanMessages.length);
            message = meEncantanMessages[messageIndex];
        }

        // Guardar el mensaje y la fecha en localStorage
        localStorage.setItem('lastShownDate', today);
        localStorage.setItem('lastShownMessage', message);
        lastShownMessage = message;
    }

    // Mostrar el mensaje guardado
    messageElement.textContent = lastShownMessage;
}

// Manejo del clic en "Siguiente mensaje"
function nextMessage() {
    alert("Solo puedes ver un mensaje por d칤a. 춰Vuelve ma침ana para ver el pr칩ximo MI AMOR 游땢!");
}

// Mostrar/ocultar el historial de reacciones al presionar el bot칩n "Historial"
document.getElementById('toggle-history').addEventListener('click', function() {
    const history = document.getElementById('reaction-history');
    if (history.style.display === "none" || !history.style.display) {
        history.style.display = "block";
    } else {
        history.style.display = "none";
    }
});

// Agregar emoji a un mensaje y guardarlo en el historial
function addEmoji() {
    const selectedEmoji = document.getElementById('emoji-selector').value;
    const currentMessage = document.getElementById('love-message').textContent;
    const selectedCategory = localStorage.getItem('selectedCategory');

    if (selectedEmoji && currentMessage) {
        let reactionHistory = JSON.parse(localStorage.getItem('reactionHistory')) || {};
        if (!reactionHistory[selectedCategory]) {
            reactionHistory[selectedCategory] = [];
        }

        // Verificar si ya se reaccion칩 a este mensaje
        const hasReacted = reactionHistory[selectedCategory].some(entry => entry.message === currentMessage);
        if (hasReacted) {
            alert("춰Ya has reaccionado a este mensaje!");
            return;
        }

        // Guardar la nueva reacci칩n
        reactionHistory[selectedCategory].push({ message: currentMessage, emoji: selectedEmoji });
        localStorage.setItem('reactionHistory', JSON.stringify(reactionHistory));
        displayReactionHistory();
    }
}

// Mostrar el historial de mensajes reaccionados con numeraci칩n y categor칤a
function displayReactionHistory() {
    const reactionHistory = JSON.parse(localStorage.getItem('reactionHistory')) || {};
    const reactionsContainer = document.getElementById('reactions-container');
    reactionsContainer.innerHTML = '';

    Object.keys(reactionHistory).forEach(category => {
        reactionHistory[category].forEach((entry, index) => {
            const entryElement = document.createElement('div');
            entryElement.textContent = `${index + 1}. [${category}] ${entry.message} - ${entry.emoji}`;
            reactionsContainer.appendChild(entryElement);
        });
    });
}

// Actualizar el color del tema y guardar la preferencia
function updateThemeColor() {
    const color = document.getElementById('theme-color').value;
    document.querySelector('h2').style.color = color;
    document.querySelector('button').style.backgroundColor = color;
    localStorage.setItem('themeColor', color);
}

// Actualizar el fondo y guardar la preferencia
function updateBackground() {
    const background = document.getElementById('background-selector').value;
    document.body.className = background;
    localStorage.setItem('background', background);
}

// Mostrar el video de confeti
function showConfettiVideo() {
    const videoOverlay = document.getElementById('video-overlay');
    videoOverlay.classList.remove('hidden');

    const video = document.getElementById('confetti-video');
    video.play();

    video.onended = () => {
        videoOverlay.classList.add('hidden');
    };
}

// Activar Modo Oscuro basado en la hora
function activateDarkMode() {
    const hour = new Date().getHours();
    if (hour >= 19 || hour < 7) {
        document.body.classList.add('dark-mode');
    } else {
        document.body.classList.remove('dark-mode');
    }
}

// Ajustar el brillo del personaje en el fondo
function adjustCharacterBrightness() {
    const background = document.body.className;
    const widget = document.querySelector('.widget');

    if (background === 'snoopycor' || background === 'snoopyflo' || background === 'snoopylov') {
        widget.setAttribute('data-background', background);
    }
}

// Restaurar preferencias guardadas y configurar eventos
document.addEventListener('DOMContentLoaded', () => {
    if (!lastShownDate || lastShownDate !== today) {
        selectMessageCategory();
        localStorage.setItem('lastShownDate', today);
        showConfettiVideo();
    }

    displayDailyMessage();
    displayReactionHistory();

    document.getElementById('next-message').addEventListener('click', nextMessage);
    document.getElementById('add-reaction').addEventListener('click', addEmoji);
    document.getElementById('theme-color').addEventListener('input', updateThemeColor);
    document.getElementById('background-selector').addEventListener('change', updateBackground);

    const savedThemeColor = localStorage.getItem('themeColor');
    if (savedThemeColor) {
        document.getElementById('theme-color').value = savedThemeColor;
        document.querySelector('h2').style.color = savedThemeColor;
        document.querySelector('button').style.backgroundColor = savedThemeColor;
    }

    const savedBackground = localStorage.getItem('background');
    if (savedBackground) {
        document.getElementById('background-selector').value = savedBackground;
        document.body.className = savedBackground;
    }

    activateDarkMode();
    adjustCharacterBrightness();
});
